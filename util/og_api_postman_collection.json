{
	"info": {
		"_postman_id": "d5c3e530-6147-411a-a085-420d5767778e",
		"name": "OperationsGateway API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Auth",
			"item": [
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"pm.globals.set(\"og-access-token\", jsonData);\r",
									"\r",
									"var setCookieValue = pm.response.headers.get(\"set-cookie\");\r",
									"var refreshCookieValue = setCookieValue.substring(setCookieValue.indexOf(\"=\")+1, setCookieValue.indexOf(\";\"));\r",
									"pm.globals.set(\"og-refresh-token\", refreshCookieValue);\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"username\": \"backend\",\r\n  \"password\": \"back\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{og-api}}/login",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"login"
							],
							"query": [
								{
									"key": "",
									"value": "",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Verify access token",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"token\": \"{{og-access-token}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{og-api}}/verify",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"verify"
							]
						}
					},
					"response": []
				},
				{
					"name": "Refresh access token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"pm.globals.set(\"og-access-token\", jsonData);\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Cookie",
								"value": "refresh_token={{og-refresh-token}}",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"token\": \"{{og-access-token}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{og-api}}/refresh",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"refresh"
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "bearer",
				"bearer": [
					{
						"key": "token",
						"value": "{{og-access-token}}",
						"type": "string"
					}
				]
			}
		},
		{
			"name": "Channels",
			"item": [
				{
					"name": "Get Channels",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/channels",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"channels"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Channel By Name",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/channels/N_FLUOR_INTEGRATION",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"channels",
								"N_FLUOR_INTEGRATION"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Channel Summary",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/channels/summary/N_COMP_FF_E",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"channels",
								"summary",
								"N_COMP_FF_E"
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "bearer",
				"bearer": [
					{
						"key": "token",
						"value": "{{og-access-token}}",
						"type": "string"
					}
				]
			}
		},
		{
			"name": "Ingestion",
			"item": [
				{
					"name": "Submit HDF File",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"description": "Upload your own HDF file created by the OG-HDF5 converter",
									"type": "file",
									"src": [],
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{og-api}}/submit/hdf",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"submit",
								"hdf"
							]
						}
					},
					"response": []
				},
				{
					"name": "Submit Channel Manifest",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": [],
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{og-api}}/submit/manifest",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"submit",
								"manifest"
							],
							"query": [
								{
									"key": "bypass_channel_check",
									"value": "true",
									"disabled": true
								}
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "bearer",
				"bearer": [
					{
						"key": "token",
						"value": "{{og-access-token}}",
						"type": "string"
					}
				]
			}
		},
		{
			"name": "Records",
			"item": [
				{
					"name": "Get Records",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/records",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"records"
							],
							"query": [
								{
									"key": "limit",
									"value": "2",
									"description": "Limit 2 records",
									"disabled": true
								},
								{
									"key": "skip",
									"value": "35",
									"description": "Skip 35 records",
									"disabled": true
								},
								{
									"key": "order",
									"value": "metadata.shotnum asc",
									"description": "Order by shot number, ascending",
									"disabled": true
								},
								{
									"key": "order",
									"value": "_id desc",
									"description": "Order by id, descending",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"_id\": {\"$eq\": \"20220408132830\"}}",
									"description": "Return records matching the given ID",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"metadata.shotnum\": 366372}",
									"description": "Look for records WHERE shot number is 366372",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"metadata.shotnum\": {\"$lt\": 366280}}",
									"description": "Return records with a shot number < 366285",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"channels.N_COMP_FF_XPOS.data\": {\"$lt\": 310}}",
									"description": "WHERE N_COMP_FF_XPOS's data < 310",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"channels.N_COMP_SPEC_TRACE.waveform_id\": {\"$eq\": \"20220408132830_N_COMP_SPEC_TRACE\"}}",
									"description": "Return record that matches the waveform ID",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"$or\": [{\"metadata.shotnum\": {\"$eq\": 366371}}, {\"metadata.shotnum\": {\"$gt\": 366374}}]}",
									"description": "Condition using OR and equality operators",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"$and\": [{\"metadata.timestamp\": {\"$gt\": \"2022-04-07 14:00:00\", \"$lt\": \"2022-04-08 08:00:00\"}}]}",
									"description": "Search by date",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"channels.N_COMP_SPEC_TRACE\": {\"$exists\": true}}",
									"description": "Return records where N_COMP_SPEC_TRACE channel exists",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"channels.N_LEG1_GREEN_NF_YPOS.data\": {\"$exists\": false}}",
									"description": "Return records that do not have data for the N_LEG1_GREEN_NF_YPOS channel",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"metadata.shotnum\": {\"$exists\": true}}",
									"description": "Return only environmental data",
									"disabled": true
								},
								{
									"key": "projection",
									"value": "metadata.shotnum",
									"description": "Return shot numbers only. Use multiple projection parameters to select multiple fields",
									"disabled": true
								},
								{
									"key": "projection",
									"value": "metadata.timestamp",
									"description": "Return timestamps only",
									"disabled": true
								},
								{
									"key": "projection",
									"value": "channels.N_COMP_FF_E",
									"description": "Return N_COMP_FF_E only",
									"disabled": true
								},
								{
									"key": "truncate",
									"value": "true",
									"description": "Truncate base64 thumbnail outputs",
									"disabled": true
								},
								{
									"key": "projection",
									"value": "channels.N_COMP_NF_IMAGE.thumbnail",
									"disabled": true
								},
								{
									"key": "projection",
									"value": "channels.N_COMP_FF_IMAGE.metadata.channel_dtype",
									"disabled": true
								},
								{
									"key": "lower_level",
									"value": "50",
									"disabled": true
								},
								{
									"key": "upper_level",
									"value": "200",
									"disabled": true
								},
								{
									"key": "colourmap_name",
									"value": "jet_r",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Count Records",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/records/count",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"records",
								"count"
							],
							"query": [
								{
									"key": "conditions",
									"value": "{\"metadata.shotnum\": 366372}",
									"description": "WHERE shot number = 366372",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"metadata.shotnum\": {\"$lt\": 366280}}",
									"description": "WHERE shot number < 366280",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"$or\": [{\"metadata.shotnum\": {\"$eq\": 366371}}, {\"metadata.shotnum\": {\"$gt\": 366372}}]}",
									"description": "WHERE shot number = 366371 OR shot number >366372",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"channels.N_COMP_FF_XPOS.data\": {\"$lt\": 310}}",
									"description": "WHERE N_COMP_FF_XPOS's data < 310",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"$and\": [{\"metadata.timestamp\": {\"$gt\": \"2022-04-07 14:00:00\", \"$lt\": \"2022-04-08 08:00:00\"}}]}",
									"description": "WHERE timestamp > _ AND < _",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"channels.N_COMP_SPEC_TRACE\": {\"$exists\": true}}",
									"description": "WHERE the N_COMP_SPEC_TRACE channel exists",
									"disabled": true
								},
								{
									"key": "conditions",
									"value": "{\"metadata.shotnum\": {\"$exists\": false}}",
									"description": "WHERE record is environmental data",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Record By ID",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/records/20220408132830",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"records",
								"20220408132830"
							],
							"query": [
								{
									"key": "lower_level",
									"value": "50",
									"disabled": true
								},
								{
									"key": "upper_level",
									"value": "200",
									"disabled": true
								},
								{
									"key": "colourmap_name",
									"value": "jet_r",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Record By ID",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{og-api}}/records/20220408142911",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"records",
								"20220408142911"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Waveform By ID",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/waveforms/20220408140310/N_COMP_SPEC_TRACE",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"waveforms",
								"20220408140310",
								"N_COMP_SPEC_TRACE"
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "bearer",
				"bearer": [
					{
						"key": "token",
						"value": "{{og-access-token}}",
						"type": "string"
					}
				]
			}
		},
		{
			"name": "Images",
			"item": [
				{
					"name": "Get Image",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/images/20220408002114/N_LEG1_GREEN_NF_IMAGE",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"images",
								"20220408002114",
								"N_LEG1_GREEN_NF_IMAGE"
							],
							"query": [
								{
									"key": "original_image",
									"value": "true",
									"disabled": true
								},
								{
									"key": "lower_level",
									"value": "50",
									"disabled": true
								},
								{
									"key": "upper_level",
									"value": "200",
									"disabled": true
								},
								{
									"key": "colourmap_name",
									"value": "jet_r",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get colour bar image",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/images/colour_bar",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"images",
								"colour_bar"
							],
							"query": [
								{
									"key": "lower_level",
									"value": "75",
									"disabled": true
								},
								{
									"key": "upper_level",
									"value": "175",
									"disabled": true
								},
								{
									"key": "colourmap_name",
									"value": "jet_r",
									"disabled": true
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get colourmap names",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{og-access-token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{og-api}}/images/colourmap_names",
							"host": [
								"{{og-api}}"
							],
							"path": [
								"images",
								"colourmap_names"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "og-api",
			"value": "http://localhost:8000",
			"disabled": true
		},
		{
			"key": "og-api",
			"value": "opsgateway-epac-dev.clf.stfc.ac.uk:8000"
		},
		{
			"key": "og-api",
			"value": "",
			"disabled": true
		}
	]
}